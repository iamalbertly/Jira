{"version":3,"names":["test","expect","path","describe","page","goto","hasLogin","locator","isVisible","catch","skip","feedbackToggle","toBeVisible","click","feedbackPanel","feedbackEmailValue","feedbackMessageValue","fill","submitBtn","responsePromise","waitForResponse","resp","url","includes","response","ok","status","toContainText","feedbackFilePath","join","process","cwd","readFileSync","existsSync","toBeTruthy","content","lines","split","filter","line","trim","length","toBeGreaterThan","entries","map","JSON","parse","Boolean","matchingEntry","find","entry","email","message","dateDisplay","text","textContent","not","toContain"],"sources":["Jira-Reporting-App-Feedback-UX-Tests.spec.js"],"sourcesContent":["import { test, expect } from '@playwright/test';\r\nimport path from 'path';\r\n\r\ntest.describe('Jira Reporting App - Feedback & Date Display Tests', () => {\r\n  test('feedback panel toggles and submits', async ({ page }) => {\r\n    await page.goto('/report');\r\n    const hasLogin = await page.locator('#username').isVisible().catch(() => false);\r\n    if (hasLogin) {\r\n      test.skip(true, 'Auth enabled - feedback test requires authenticated session');\r\n      return;\r\n    }\r\n    const feedbackToggle = page.locator('#feedback-toggle');\r\n    await expect(feedbackToggle).toBeVisible();\r\n\r\n    await feedbackToggle.click();\r\n    const feedbackPanel = page.locator('#feedback-panel');\r\n    await expect(feedbackPanel).toBeVisible();\r\n\r\n    const feedbackEmailValue = 'leader@example.com';\r\n    const feedbackMessageValue = 'Clarify SP per Day and On-Time % definitions.';\r\n\r\n    await page.fill('#feedback-email', feedbackEmailValue);\r\n    await page.fill('#feedback-message', feedbackMessageValue);\r\n\r\n    const submitBtn = page.locator('#feedback-submit');\r\n    const responsePromise = page.waitForResponse(resp => resp.url().includes('/feedback')).catch(() => null);\r\n    await submitBtn.click();\r\n\r\n    const response = await responsePromise;\r\n    if (!response) {\r\n      test.skip('Feedback submission did not return a response (server may be unavailable).');\r\n      return;\r\n    }\r\n\r\n    if (!response.ok()) {\r\n      test.skip(`Feedback submission failed with status ${response.status()}`);\r\n      return;\r\n    }\r\n\r\n    await expect(page.locator('#feedback-status')).toContainText('Thanks');\r\n\r\n    // Verify feedback was persisted to the server-side log file\r\n    const feedbackFilePath = path.join(process.cwd(), 'data', 'JiraReporting-Feedback-UserInput-Submission-Log.jsonl');\r\n    const { readFileSync, existsSync } = await import('fs');\r\n\r\n    expect(existsSync(feedbackFilePath)).toBeTruthy();\r\n\r\n    const content = readFileSync(feedbackFilePath, 'utf-8');\r\n    const lines = content.split('\\n').filter(line => line.trim().length > 0);\r\n    expect(lines.length).toBeGreaterThan(0);\r\n\r\n    const entries = lines.map(line => {\r\n      try {\r\n        return JSON.parse(line);\r\n      } catch {\r\n        return null;\r\n      }\r\n    }).filter(Boolean);\r\n\r\n    const matchingEntry = entries.find(entry => entry.email === feedbackEmailValue && entry.message === feedbackMessageValue);\r\n    expect(matchingEntry).toBeTruthy();\r\n  });\r\n\r\n  test('date display uses friendly formatting', async ({ page }) => {\r\n    await page.goto('/report');\r\n    const hasLogin = await page.locator('#username').isVisible().catch(() => false);\r\n    if (hasLogin) {\r\n      test.skip(true, 'Auth enabled - date display test requires report access');\r\n      return;\r\n    }\r\n    await page.fill('#start-date', '2025-07-01T00:00');\r\n    await page.fill('#end-date', '2025-09-30T23:59');\r\n\r\n    const dateDisplay = page.locator('#date-display');\r\n    await expect(dateDisplay).toContainText('UTC');\r\n\r\n    const text = (await dateDisplay.textContent()) || '';\r\n    expect(text).not.toContain('T00:00:00.000Z');\r\n    expect(text).not.toContain('.000Z');\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}