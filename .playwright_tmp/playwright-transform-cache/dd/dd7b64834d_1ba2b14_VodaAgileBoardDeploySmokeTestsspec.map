{"version":3,"names":["test","expect","testUser","process","env","TEST_LOGIN_USER","APP_LOGIN_USER","testPass","TEST_LOGIN_PASSWORD","APP_LOGIN_PASSWORD","captureConsoleErrors","page","errors","on","msg","type","push","text","describe","setTimeout","consoleErrors","goto","waitUntil","hasLogin","locator","isVisible","catch","skip","fill","click","waitForURL","timeout","url","match","toContainText","toBeVisible","Promise","race","waitForSelector","state","loading","hasContent","hasError","toBeTruthy","errorEvents","filter","e","toHaveLength"],"sources":["VodaAgileBoard-Deploy-Smoke-Tests.spec.js"],"sourcesContent":["import { test, expect } from '@playwright/test';\r\n\r\nconst testUser = process.env.TEST_LOGIN_USER || process.env.APP_LOGIN_USER || '';\r\nconst testPass = process.env.TEST_LOGIN_PASSWORD || process.env.APP_LOGIN_PASSWORD || '';\r\n\r\nfunction captureConsoleErrors(page) {\r\n  const errors = [];\r\n  page.on('console', (msg) => {\r\n    if (msg.type() === 'error') errors.push({ type: msg.type(), text: msg.text() });\r\n  });\r\n  return errors;\r\n}\r\n\r\n// Smoke tests to validate a running deployment (local or Render)\r\ntest.describe('VodaAgileBoard â€“ Deploy Smoke Tests', () => {\r\n  test('core sprint report flow works on current BASE_URL', async ({ page }) => {\r\n    test.setTimeout(300000);\r\n    const consoleErrors = captureConsoleErrors(page);\r\n\r\n    await page.goto('/', { waitUntil: 'load' });\r\n\r\n    const hasLogin = await page.locator('#username').isVisible().catch(() => false);\r\n    if (hasLogin) {\r\n      if (!testUser || !testPass) {\r\n        test.skip(true, 'Auth enabled but no test credentials provided');\r\n        return;\r\n      }\r\n      await page.fill('#username', testUser);\r\n      await page.fill('#password', testPass);\r\n      await page.click('button[type=\"submit\"]');\r\n      await page.waitForURL(/\\/report/, { timeout: 20000 });\r\n    } else {\r\n      if (!page.url().match(/\\/report$/)) {\r\n        await page.goto('/report');\r\n      }\r\n    }\r\n\r\n    await expect(page.locator('h1')).toContainText('VodaAgileBoard');\r\n    await expect(page.locator('#preview-btn')).toBeVisible();\r\n    await expect(page.locator('#project-mpsa')).toBeVisible();\r\n    await expect(page.locator('#project-mas')).toBeVisible();\r\n\r\n    await page.click('#preview-btn');\r\n\r\n    await Promise.race([\r\n      page.waitForSelector('#loading', { state: 'visible', timeout: 10000 }).catch(() => null),\r\n      page.waitForSelector('#preview-content', { state: 'visible', timeout: 30000 }).catch(() => null),\r\n      page.waitForSelector('#error', { state: 'visible', timeout: 30000 }).catch(() => null),\r\n    ]);\r\n\r\n    const loading = await page.locator('#loading').isVisible().catch(() => false);\r\n    if (loading) await page.waitForSelector('#loading', { state: 'hidden', timeout: 240000 });\r\n\r\n    const hasContent = await page.locator('#preview-content').isVisible().catch(() => false);\r\n    const hasError = await page.locator('#error').isVisible().catch(() => false);\r\n    expect(hasContent || hasError).toBeTruthy();\r\n\r\n    const errorEvents = consoleErrors.filter((e) => e.type === 'error');\r\n    expect(errorEvents).toHaveLength(0);\r\n  });\r\n});\r\n\r\n"],"mappings":"AAAA,SAASA,IAAI,EAAEC,MAAM,QAAQ,kBAAkB;AAE/C,MAAMC,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,eAAe,IAAIF,OAAO,CAACC,GAAG,CAACE,cAAc,IAAI,EAAE;AAChF,MAAMC,QAAQ,GAAGJ,OAAO,CAACC,GAAG,CAACI,mBAAmB,IAAIL,OAAO,CAACC,GAAG,CAACK,kBAAkB,IAAI,EAAE;AAExF,SAASC,oBAAoBA,CAACC,IAAI,EAAE;EAClC,MAAMC,MAAM,GAAG,EAAE;EACjBD,IAAI,CAACE,EAAE,CAAC,SAAS,EAAGC,GAAG,IAAK;IAC1B,IAAIA,GAAG,CAACC,IAAI,CAAC,CAAC,KAAK,OAAO,EAAEH,MAAM,CAACI,IAAI,CAAC;MAAED,IAAI,EAAED,GAAG,CAACC,IAAI,CAAC,CAAC;MAAEE,IAAI,EAAEH,GAAG,CAACG,IAAI,CAAC;IAAE,CAAC,CAAC;EACjF,CAAC,CAAC;EACF,OAAOL,MAAM;AACf;;AAEA;AACAZ,IAAI,CAACkB,QAAQ,CAAC,qCAAqC,EAAE,MAAM;EACzDlB,IAAI,CAAC,mDAAmD,EAAE,OAAO;IAAEW;EAAK,CAAC,KAAK;IAC5EX,IAAI,CAACmB,UAAU,CAAC,MAAM,CAAC;IACvB,MAAMC,aAAa,GAAGV,oBAAoB,CAACC,IAAI,CAAC;IAEhD,MAAMA,IAAI,CAACU,IAAI,CAAC,GAAG,EAAE;MAAEC,SAAS,EAAE;IAAO,CAAC,CAAC;IAE3C,MAAMC,QAAQ,GAAG,MAAMZ,IAAI,CAACa,OAAO,CAAC,WAAW,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,KAAK,CAAC;IAC/E,IAAIH,QAAQ,EAAE;MACZ,IAAI,CAACrB,QAAQ,IAAI,CAACK,QAAQ,EAAE;QAC1BP,IAAI,CAAC2B,IAAI,CAAC,IAAI,EAAE,+CAA+C,CAAC;QAChE;MACF;MACA,MAAMhB,IAAI,CAACiB,IAAI,CAAC,WAAW,EAAE1B,QAAQ,CAAC;MACtC,MAAMS,IAAI,CAACiB,IAAI,CAAC,WAAW,EAAErB,QAAQ,CAAC;MACtC,MAAMI,IAAI,CAACkB,KAAK,CAAC,uBAAuB,CAAC;MACzC,MAAMlB,IAAI,CAACmB,UAAU,CAAC,UAAU,EAAE;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACvD,CAAC,MAAM;MACL,IAAI,CAACpB,IAAI,CAACqB,GAAG,CAAC,CAAC,CAACC,KAAK,CAAC,WAAW,CAAC,EAAE;QAClC,MAAMtB,IAAI,CAACU,IAAI,CAAC,SAAS,CAAC;MAC5B;IACF;IAEA,MAAMpB,MAAM,CAACU,IAAI,CAACa,OAAO,CAAC,IAAI,CAAC,CAAC,CAACU,aAAa,CAAC,gBAAgB,CAAC;IAChE,MAAMjC,MAAM,CAACU,IAAI,CAACa,OAAO,CAAC,cAAc,CAAC,CAAC,CAACW,WAAW,CAAC,CAAC;IACxD,MAAMlC,MAAM,CAACU,IAAI,CAACa,OAAO,CAAC,eAAe,CAAC,CAAC,CAACW,WAAW,CAAC,CAAC;IACzD,MAAMlC,MAAM,CAACU,IAAI,CAACa,OAAO,CAAC,cAAc,CAAC,CAAC,CAACW,WAAW,CAAC,CAAC;IAExD,MAAMxB,IAAI,CAACkB,KAAK,CAAC,cAAc,CAAC;IAEhC,MAAMO,OAAO,CAACC,IAAI,CAAC,CACjB1B,IAAI,CAAC2B,eAAe,CAAC,UAAU,EAAE;MAAEC,KAAK,EAAE,SAAS;MAAER,OAAO,EAAE;IAAM,CAAC,CAAC,CAACL,KAAK,CAAC,MAAM,IAAI,CAAC,EACxFf,IAAI,CAAC2B,eAAe,CAAC,kBAAkB,EAAE;MAAEC,KAAK,EAAE,SAAS;MAAER,OAAO,EAAE;IAAM,CAAC,CAAC,CAACL,KAAK,CAAC,MAAM,IAAI,CAAC,EAChGf,IAAI,CAAC2B,eAAe,CAAC,QAAQ,EAAE;MAAEC,KAAK,EAAE,SAAS;MAAER,OAAO,EAAE;IAAM,CAAC,CAAC,CAACL,KAAK,CAAC,MAAM,IAAI,CAAC,CACvF,CAAC;IAEF,MAAMc,OAAO,GAAG,MAAM7B,IAAI,CAACa,OAAO,CAAC,UAAU,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,KAAK,CAAC;IAC7E,IAAIc,OAAO,EAAE,MAAM7B,IAAI,CAAC2B,eAAe,CAAC,UAAU,EAAE;MAAEC,KAAK,EAAE,QAAQ;MAAER,OAAO,EAAE;IAAO,CAAC,CAAC;IAEzF,MAAMU,UAAU,GAAG,MAAM9B,IAAI,CAACa,OAAO,CAAC,kBAAkB,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,KAAK,CAAC;IACxF,MAAMgB,QAAQ,GAAG,MAAM/B,IAAI,CAACa,OAAO,CAAC,QAAQ,CAAC,CAACC,SAAS,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,KAAK,CAAC;IAC5EzB,MAAM,CAACwC,UAAU,IAAIC,QAAQ,CAAC,CAACC,UAAU,CAAC,CAAC;IAE3C,MAAMC,WAAW,GAAGxB,aAAa,CAACyB,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAAC/B,IAAI,KAAK,OAAO,CAAC;IACnEd,MAAM,CAAC2C,WAAW,CAAC,CAACG,YAAY,CAAC,CAAC,CAAC;EACrC,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}