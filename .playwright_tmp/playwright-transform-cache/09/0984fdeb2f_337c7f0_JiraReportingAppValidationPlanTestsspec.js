import { test, expect } from '@playwright/test';
import { captureBrowserTelemetry } from './JiraReporting-Tests-Shared-PreviewExport-Helpers.js';
test.describe('Jira Reporting App - Validation Plan (UI + Telemetry)', () => {
  test('report page loads with expected controls and no console errors', async ({
    page
  }) => {
    const telemetry = captureBrowserTelemetry(page);
    await page.goto('/report');
    await expect(page.locator('h1')).toContainText('VodaAgileBoard');
    await expect(page.locator('#project-mpsa')).toBeVisible();
    await expect(page.locator('#project-mas')).toBeVisible();
    await expect(page.locator('#start-date')).toBeVisible();
    await expect(page.locator('#end-date')).toBeVisible();
    await expect(page.locator('#preview-btn')).toBeVisible();

    // Main nav: Report | Current Sprint | Leadership
    const nav = page.locator('nav.app-nav');
    await expect(nav).toBeVisible();
    await expect(nav.locator('a[href="/current-sprint"]')).toContainText('Current Sprint');
    await expect(nav.locator('a[href="/sprint-leadership"]')).toContainText('Leadership');

    // Tabs are present in the DOM but hidden until preview is generated
    await expect(page.locator('.tabs')).toHaveCount(1);
    await expect(page.locator('#preview-content')).toBeHidden();

    // Export buttons should be present (may be disabled before preview)
    await expect(page.locator('#export-excel-btn')).toBeVisible();
    await expect(page.locator('#export-dropdown-trigger')).toBeVisible();

    // Validate no browser errors on load (ignoring favicon noise)
    expect(telemetry.consoleErrors).toEqual([]);
    expect(telemetry.pageErrors).toEqual([]);
    expect(telemetry.failedRequests).toEqual([]);
  });
  test('preview button disables when no projects are selected', async ({
    page
  }) => {
    const telemetry = captureBrowserTelemetry(page);
    await page.goto('/report');
    await page.uncheck('#project-mpsa');
    await page.uncheck('#project-mas');
    const previewButton = page.locator('#preview-btn');
    await expect(previewButton).toBeDisabled();
    await expect(previewButton).toHaveAttribute('title', /select at least one project/i);
    expect(telemetry.consoleErrors).toEqual([]);
    expect(telemetry.pageErrors).toEqual([]);
  });
  test('preview button validates date ordering and shows error state', async ({
    page
  }) => {
    const telemetry = captureBrowserTelemetry(page);
    await page.goto('/report');
    await page.check('#project-mpsa');
    await page.fill('#start-date', '2025-09-30T23:59');
    await page.fill('#end-date', '2025-07-01T00:00');
    await page.click('#preview-btn');
    const errorBanner = page.locator('#error');
    await expect(errorBanner).toBeVisible();
    await expect(errorBanner).toContainText('Start date must be before end date');
    expect(telemetry.consoleErrors).toEqual([]);
    expect(telemetry.pageErrors).toEqual([]);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ0ZXN0IiwiZXhwZWN0IiwiY2FwdHVyZUJyb3dzZXJUZWxlbWV0cnkiLCJkZXNjcmliZSIsInBhZ2UiLCJ0ZWxlbWV0cnkiLCJnb3RvIiwibG9jYXRvciIsInRvQ29udGFpblRleHQiLCJ0b0JlVmlzaWJsZSIsIm5hdiIsInRvSGF2ZUNvdW50IiwidG9CZUhpZGRlbiIsImNvbnNvbGVFcnJvcnMiLCJ0b0VxdWFsIiwicGFnZUVycm9ycyIsImZhaWxlZFJlcXVlc3RzIiwidW5jaGVjayIsInByZXZpZXdCdXR0b24iLCJ0b0JlRGlzYWJsZWQiLCJ0b0hhdmVBdHRyaWJ1dGUiLCJjaGVjayIsImZpbGwiLCJjbGljayIsImVycm9yQmFubmVyIl0sInNvdXJjZXMiOlsiSmlyYS1SZXBvcnRpbmctQXBwLVZhbGlkYXRpb24tUGxhbi1UZXN0cy5zcGVjLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHRlc3QsIGV4cGVjdCB9IGZyb20gJ0BwbGF5d3JpZ2h0L3Rlc3QnO1xuaW1wb3J0IHsgY2FwdHVyZUJyb3dzZXJUZWxlbWV0cnkgfSBmcm9tICcuL0ppcmFSZXBvcnRpbmctVGVzdHMtU2hhcmVkLVByZXZpZXdFeHBvcnQtSGVscGVycy5qcyc7XG5cbnRlc3QuZGVzY3JpYmUoJ0ppcmEgUmVwb3J0aW5nIEFwcCAtIFZhbGlkYXRpb24gUGxhbiAoVUkgKyBUZWxlbWV0cnkpJywgKCkgPT4ge1xuICB0ZXN0KCdyZXBvcnQgcGFnZSBsb2FkcyB3aXRoIGV4cGVjdGVkIGNvbnRyb2xzIGFuZCBubyBjb25zb2xlIGVycm9ycycsIGFzeW5jICh7IHBhZ2UgfSkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNhcHR1cmVCcm93c2VyVGVsZW1ldHJ5KHBhZ2UpO1xuXG4gICAgYXdhaXQgcGFnZS5nb3RvKCcvcmVwb3J0Jyk7XG5cbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdoMScpKS50b0NvbnRhaW5UZXh0KCdWb2RhQWdpbGVCb2FyZCcpO1xuICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJyNwcm9qZWN0LW1wc2EnKSkudG9CZVZpc2libGUoKTtcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcjcHJvamVjdC1tYXMnKSkudG9CZVZpc2libGUoKTtcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcjc3RhcnQtZGF0ZScpKS50b0JlVmlzaWJsZSgpO1xuICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJyNlbmQtZGF0ZScpKS50b0JlVmlzaWJsZSgpO1xuICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJyNwcmV2aWV3LWJ0bicpKS50b0JlVmlzaWJsZSgpO1xuXG4gICAgLy8gTWFpbiBuYXY6IFJlcG9ydCB8IEN1cnJlbnQgU3ByaW50IHwgTGVhZGVyc2hpcFxuICAgIGNvbnN0IG5hdiA9IHBhZ2UubG9jYXRvcignbmF2LmFwcC1uYXYnKTtcbiAgICBhd2FpdCBleHBlY3QobmF2KS50b0JlVmlzaWJsZSgpO1xuICAgIGF3YWl0IGV4cGVjdChuYXYubG9jYXRvcignYVtocmVmPVwiL2N1cnJlbnQtc3ByaW50XCJdJykpLnRvQ29udGFpblRleHQoJ0N1cnJlbnQgU3ByaW50Jyk7XG4gICAgYXdhaXQgZXhwZWN0KG5hdi5sb2NhdG9yKCdhW2hyZWY9XCIvc3ByaW50LWxlYWRlcnNoaXBcIl0nKSkudG9Db250YWluVGV4dCgnTGVhZGVyc2hpcCcpO1xuXG4gICAgLy8gVGFicyBhcmUgcHJlc2VudCBpbiB0aGUgRE9NIGJ1dCBoaWRkZW4gdW50aWwgcHJldmlldyBpcyBnZW5lcmF0ZWRcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcudGFicycpKS50b0hhdmVDb3VudCgxKTtcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcjcHJldmlldy1jb250ZW50JykpLnRvQmVIaWRkZW4oKTtcblxuICAgIC8vIEV4cG9ydCBidXR0b25zIHNob3VsZCBiZSBwcmVzZW50IChtYXkgYmUgZGlzYWJsZWQgYmVmb3JlIHByZXZpZXcpXG4gICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignI2V4cG9ydC1leGNlbC1idG4nKSkudG9CZVZpc2libGUoKTtcbiAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcjZXhwb3J0LWRyb3Bkb3duLXRyaWdnZXInKSkudG9CZVZpc2libGUoKTtcblxuICAgIC8vIFZhbGlkYXRlIG5vIGJyb3dzZXIgZXJyb3JzIG9uIGxvYWQgKGlnbm9yaW5nIGZhdmljb24gbm9pc2UpXG4gICAgZXhwZWN0KHRlbGVtZXRyeS5jb25zb2xlRXJyb3JzKS50b0VxdWFsKFtdKTtcbiAgICBleHBlY3QodGVsZW1ldHJ5LnBhZ2VFcnJvcnMpLnRvRXF1YWwoW10pO1xuICAgIGV4cGVjdCh0ZWxlbWV0cnkuZmFpbGVkUmVxdWVzdHMpLnRvRXF1YWwoW10pO1xuICB9KTtcblxuICB0ZXN0KCdwcmV2aWV3IGJ1dHRvbiBkaXNhYmxlcyB3aGVuIG5vIHByb2plY3RzIGFyZSBzZWxlY3RlZCcsIGFzeW5jICh7IHBhZ2UgfSkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeSA9IGNhcHR1cmVCcm93c2VyVGVsZW1ldHJ5KHBhZ2UpO1xuXG4gICAgYXdhaXQgcGFnZS5nb3RvKCcvcmVwb3J0Jyk7XG5cbiAgICBhd2FpdCBwYWdlLnVuY2hlY2soJyNwcm9qZWN0LW1wc2EnKTtcbiAgICBhd2FpdCBwYWdlLnVuY2hlY2soJyNwcm9qZWN0LW1hcycpO1xuXG4gICAgY29uc3QgcHJldmlld0J1dHRvbiA9IHBhZ2UubG9jYXRvcignI3ByZXZpZXctYnRuJyk7XG4gICAgYXdhaXQgZXhwZWN0KHByZXZpZXdCdXR0b24pLnRvQmVEaXNhYmxlZCgpO1xuICAgIGF3YWl0IGV4cGVjdChwcmV2aWV3QnV0dG9uKS50b0hhdmVBdHRyaWJ1dGUoJ3RpdGxlJywgL3NlbGVjdCBhdCBsZWFzdCBvbmUgcHJvamVjdC9pKTtcblxuICAgIGV4cGVjdCh0ZWxlbWV0cnkuY29uc29sZUVycm9ycykudG9FcXVhbChbXSk7XG4gICAgZXhwZWN0KHRlbGVtZXRyeS5wYWdlRXJyb3JzKS50b0VxdWFsKFtdKTtcbiAgfSk7XG5cbiAgdGVzdCgncHJldmlldyBidXR0b24gdmFsaWRhdGVzIGRhdGUgb3JkZXJpbmcgYW5kIHNob3dzIGVycm9yIHN0YXRlJywgYXN5bmMgKHsgcGFnZSB9KSA9PiB7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gY2FwdHVyZUJyb3dzZXJUZWxlbWV0cnkocGFnZSk7XG5cbiAgICBhd2FpdCBwYWdlLmdvdG8oJy9yZXBvcnQnKTtcblxuICAgIGF3YWl0IHBhZ2UuY2hlY2soJyNwcm9qZWN0LW1wc2EnKTtcbiAgICBhd2FpdCBwYWdlLmZpbGwoJyNzdGFydC1kYXRlJywgJzIwMjUtMDktMzBUMjM6NTknKTtcbiAgICBhd2FpdCBwYWdlLmZpbGwoJyNlbmQtZGF0ZScsICcyMDI1LTA3LTAxVDAwOjAwJyk7XG5cbiAgICBhd2FpdCBwYWdlLmNsaWNrKCcjcHJldmlldy1idG4nKTtcblxuICAgIGNvbnN0IGVycm9yQmFubmVyID0gcGFnZS5sb2NhdG9yKCcjZXJyb3InKTtcbiAgICBhd2FpdCBleHBlY3QoZXJyb3JCYW5uZXIpLnRvQmVWaXNpYmxlKCk7XG4gICAgYXdhaXQgZXhwZWN0KGVycm9yQmFubmVyKS50b0NvbnRhaW5UZXh0KCdTdGFydCBkYXRlIG11c3QgYmUgYmVmb3JlIGVuZCBkYXRlJyk7XG5cbiAgICBleHBlY3QodGVsZW1ldHJ5LmNvbnNvbGVFcnJvcnMpLnRvRXF1YWwoW10pO1xuICAgIGV4cGVjdCh0ZWxlbWV0cnkucGFnZUVycm9ycykudG9FcXVhbChbXSk7XG4gIH0pO1xufSk7XG4iXSwibWFwcGluZ3MiOiJBQUFBLFNBQVNBLElBQUksRUFBRUMsTUFBTSxRQUFRLGtCQUFrQjtBQUMvQyxTQUFTQyx1QkFBdUIsUUFBUSx1REFBdUQ7QUFFL0ZGLElBQUksQ0FBQ0csUUFBUSxDQUFDLHVEQUF1RCxFQUFFLE1BQU07RUFDM0VILElBQUksQ0FBQyxnRUFBZ0UsRUFBRSxPQUFPO0lBQUVJO0VBQUssQ0FB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