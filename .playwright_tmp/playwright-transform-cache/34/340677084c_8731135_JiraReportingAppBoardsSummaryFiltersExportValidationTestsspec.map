{"version":3,"names":["test","expect","runDefaultPreview","waitForPreview","describe","beforeEach","page","setExtraHTTPHeaders","goto","click","boardsSection","locator","toBeVisible","timeout","sectionText","textContent","includes","toContainText","table","first","tfoot","summaryRow","hasTfoot","count","summaryRowLocator","summaryText","hasLabel","trim","length","toBeTruthy","numericCell","nth","skip","trigger","hover","popover","toHaveAttribute","text","searchBox","pills","fill","waitForTimeout","content","hasEmptyMessage","hasTable","primaryBtn","dropdownTrigger","menu","consoleErrors","on","msg","type","push","relevant","filter","t","toEqual"],"sources":["Jira-Reporting-App-Boards-Summary-Filters-Export-Validation-Tests.spec.js"],"sourcesContent":["/**\r\n * Boards Summary, Filters, and Export Validation Tests\r\n * Validates: Boards table summary row (tfoot), tap-friendly tooltips, unified filters on Boards/Sprints,\r\n * export split button (full vs filtered), and no console errors.\r\n */\r\n\r\nimport { test, expect } from '@playwright/test';\r\nimport { runDefaultPreview, waitForPreview } from './JiraReporting-Tests-Shared-PreviewExport-Helpers.js';\r\n\r\ntest.describe('Jira Reporting App - Boards Summary Filters Export Validation Tests', () => {\r\n  test.beforeEach(async ({ page }) => {\r\n    page.setExtraHTTPHeaders({ 'Accept': 'text/html' });\r\n  });\r\n\r\n  test('Boards table has summary row (tfoot) with Total/Summary when boards exist', async ({ page }) => {\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    await page.click('.tab-btn[data-tab=\"project-epic-level\"]');\r\n    const boardsSection = page.locator('#project-epic-level-content');\r\n    await expect(boardsSection).toBeVisible({ timeout: 5000 });\r\n    const sectionText = await boardsSection.textContent();\r\n    if (!sectionText || !sectionText.includes('Board ID')) {\r\n      await expect(boardsSection).toContainText(/No boards|discovered|date window|match the current filters/i);\r\n      return;\r\n    }\r\n    const table = boardsSection.locator('table.data-table').first();\r\n    await expect(table).toBeVisible({ timeout: 5000 });\n    const tfoot = table.locator('tfoot');\n    const summaryRow = table.locator('tr.boards-summary-row');\n    const hasTfoot = await tfoot.count() > 0;\n    if (hasTfoot) {\n      await expect(tfoot).toBeVisible({ timeout: 3000 });\n    } else {\n      await expect(summaryRow).toBeVisible({ timeout: 3000 });\n    }\n    const summaryRowLocator = hasTfoot ? table.locator('tfoot') : table.locator('tr.boards-summary-row');\n    await expect(summaryRowLocator).toBeVisible({ timeout: 3000 });\n    const summaryText = (await summaryRowLocator.textContent()) || '';\n    const hasLabel = /Total|Summary/i.test(summaryText);\n    expect(hasLabel || summaryText.trim().length > 0).toBeTruthy();\n    const numericCell = hasTfoot ? table.locator('tfoot td').nth(4) : table.locator('tr.boards-summary-row td').nth(4);\n    await expect(numericCell).toBeVisible();\n  });\n\r\n  test('Tooltip on tap: hover header shows popover with tooltip text', async ({ page }) => {\n    await page.goto('/report');\n    await runDefaultPreview(page);\n    await page.click('.tab-btn[data-tab=\"project-epic-level\"]');\n    const boardsSection = page.locator('#project-epic-level-content');\n    const sectionText = await boardsSection.textContent();\n    if (!sectionText || !sectionText.includes('Board ID')) {\n      test.skip('No boards table (no boards in window)');\n      return;\n    }\n    const trigger = page.locator('th[data-tooltip]').first();\n    await expect(trigger).toBeVisible({ timeout: 5000 });\n    await trigger.hover();\n    const popover = page.locator('#tooltip-popover');\n    await expect(popover).toBeVisible({ timeout: 3000 });\n    await expect(popover).toHaveAttribute('aria-hidden', 'false');\n    const text = await popover.textContent();\r\n    expect(text && text.length > 0).toBeTruthy();\r\n  });\r\n\r\n  test('Boards tab has search and filter controls', async ({ page }) => {\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    await page.click('.tab-btn[data-tab=\"project-epic-level\"]');\r\n    const searchBox = page.locator('#boards-search-box');\r\n    await expect(searchBox).toBeVisible({ timeout: 5000 });\r\n    await expect(searchBox).toHaveAttribute('placeholder', /Search boards/i);\r\n    const pills = page.locator('#boards-project-pills');\r\n    await expect(pills).toBeVisible({ timeout: 3000 });\r\n  });\r\n\r\n  test('Sprints tab has search and filter controls', async ({ page }) => {\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    await page.click('.tab-btn[data-tab=\"sprints\"]');\r\n    const searchBox = page.locator('#sprints-search-box');\r\n    await expect(searchBox).toBeVisible({ timeout: 5000 });\r\n    await expect(searchBox).toHaveAttribute('placeholder', /Search sprints/i);\r\n    const pills = page.locator('#sprints-project-pills');\r\n    await expect(pills).toBeVisible({ timeout: 3000 });\r\n  });\r\n\r\n  test('Boards search filters table rows or shows empty state', async ({ page }) => {\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    await page.click('.tab-btn[data-tab=\"project-epic-level\"]');\r\n    const boardsSection = page.locator('#project-epic-level-content');\r\n    const sectionText = await boardsSection.textContent();\r\n    if (!sectionText || !sectionText.includes('Board ID')) {\r\n      test.skip('No boards table (no boards in window)');\r\n      return;\r\n    }\r\n    const searchBox = page.locator('#boards-search-box');\r\n    await searchBox.fill('__nonexistent_board_xyz__');\r\n    await page.waitForTimeout(400);\r\n    const content = await boardsSection.textContent();\r\n    const hasEmptyMessage = /No boards match the current filters|match the current filters/i.test(content || '');\r\n    const hasTable = boardsSection.locator('table.data-table tbody tr').count() > 0;\r\n    expect(hasEmptyMessage || !hasTable).toBeTruthy();\r\n  });\r\n\r\n  test('Export split button: primary and dropdown with full and filtered options', async ({ page }) => {\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    const primaryBtn = page.locator('#export-excel-btn');\r\n    await expect(primaryBtn).toBeVisible({ timeout: 5000 });\r\n    await expect(primaryBtn).toContainText(/Export to Excel|all data/i);\r\n    const dropdownTrigger = page.locator('#export-dropdown-trigger');\r\n    await expect(dropdownTrigger).toBeVisible({ timeout: 3000 });\r\n    await dropdownTrigger.click();\r\n    const menu = page.locator('#export-dropdown-menu');\r\n    await expect(menu).toBeVisible({ timeout: 2000 });\r\n    await expect(menu).toHaveAttribute('aria-hidden', 'false');\r\n    await expect(menu.locator('[data-export=\"excel-full\"]')).toBeVisible();\r\n    await expect(menu.locator('[data-export=\"csv-filtered\"]')).toBeVisible();\r\n    await expect(menu.locator('[data-export=\"excel-filtered\"]')).toBeVisible();\r\n  });\r\n\r\n  test('Preview and Boards/Filters/Export flow without console errors', async ({ page }) => {\r\n    const consoleErrors = [];\r\n    page.on('console', (msg) => {\r\n      if (msg.type() === 'error') {\r\n        consoleErrors.push(msg.text());\r\n      }\r\n    });\r\n    await page.goto('/report');\r\n    await runDefaultPreview(page);\r\n    await page.click('.tab-btn[data-tab=\"project-epic-level\"]');\r\n    await page.waitForTimeout(300);\r\n    await page.click('.tab-btn[data-tab=\"sprints\"]');\r\n    await page.waitForTimeout(300);\r\n    const relevant = consoleErrors.filter(t =>\r\n      !t.includes('favicon') &&\r\n      !t.includes('404') &&\r\n      !t.includes('csv-columns')\r\n    );\r\n    expect(relevant).toEqual([]);\r\n  });\r\n});\r\n"],"mappings":"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","ignoreList":[]}